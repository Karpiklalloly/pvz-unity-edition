Да, я отлично умею работать с Markdown (`.md`). Создание подробного дизайн-документа (GDD) перед активной фазой кодинга — это профессиональный и очень правильный подход. Он поможет нам обоим иметь четкое видение проекта и избежать множества проблем в будущем.

Давайте составим его. Вот структура и наполнение GDD для нашего проекта.

---

# **Game Design Document: ECS Garden Defense**

**Версия:** 0.1
**Дата:** 22.07.2025

### **Оглавление**
1.  [Введение](#1-введение)
2.  [Основной игровой цикл](#2-основной-игровой-цикл)
3.  [Игровые механики](#3-игровые-механики)
4.  [Игровые объекты](#4-игровые-объекты)
    *   [Растения](#41-растения)
    *   [Зомби](#42-зомби)
5.  [Пользовательский интерфейс (UI/UX)](#5-пользовательский-интерфейс-uiux)
6.  [Техническая спецификация](#6-техническая-спецификация)
7.  [Арт и Звук](#7-арт-и-звук)
8.  [План разработки (Roadmap)](#8-план-разработки-roadmap)

---

### **1. Введение**

*   **Название проекта (рабочее):** ECS Garden Defense
*   **Жанр:** Tower Defense, Strategy
*   **Целевая платформа:** PC (Windows, macOS, Linux)
*   **Ключевая концепция:** Создание игры-клона Plants vs Zombies с использованием современной, высокопроизводительной архитектуры Unity и фреймворка **DragonECS**. Проект нацелен на создание чистого, масштабируемого и легко расширяемого кода, а также на глубокое изучение принципов ECS.

### **2. Основной игровой цикл**

Игрок проходит через следующий цикл действий на каждом уровне:

1.  **Фаза подготовки (вне уровня):** Игрок выбирает ограниченный набор карт-растений, которые он возьмет на уровень.
2.  **Сбор ресурсов:** В начале и во время уровня с неба падает ресурс "Солнце". Игрок кликает на него, чтобы собрать. Некоторые растения (Подсолнухи) генерируют дополнительное Солнце.
3.  **Оборона (посадка растений):** Игрок тратит накопленное Солнце на посадку растений в ячейках сетки. Каждое растение имеет свою стоимость и время перезарядки.
4.  **Сражение:** Растения автоматически атакуют приближающихся зомби на своей линии. Зомби, в свою очередь, двигаются к дому игрока и поедают растения на своем пути.
5.  **Завершение уровня:** Игрок побеждает, отразив все волны зомби. Игрок проигрывает, если хотя бы один зомби добирается до дома.

### **3. Игровые механики**

*   **Игровое поле:**
    *   Стандартная сетка размером **9x5** (9 колонок, 5 дорожек).
    *   Зомби появляются справа (за экраном) и движутся влево по своим дорожкам.
    *   Дом игрока находится слева.

*   **Ресурс "Солнце":**
    *   **Пассивный спавн:** Каждые N секунд с неба падает одно Солнце.
    *   **Активный спавн:** Растения-генераторы (Подсолнухи) производят Солнце с определенным интервалом.
    *   **Сбор:** Клик по иконке Солнца добавляет его к счетчику игрока.

*   **Посадка растений:**
    *   Осуществляется перетаскиванием карты растения с верхней панели на ячейку сетки или выбором карты и кликом на ячейку.
    *   Нельзя сажать растение, если не хватает Солнца, ячейка занята или карта находится на перезарядке.

*   **Волны зомби:**
    *   Уровни состоят из нескольких волн.
    *   Есть индикатор прогресса текущей волны.
    *   Перед "большой" финальной волной появляется специальный зомби-знаменосец и звуковое предупреждение.

*   **Газонокосилки:**
    *   Последний рубеж обороны. На каждой дорожке у дома стоит по одной газонокосилке.
    *   Активируется, когда зомби достигает ее. Уничтожает всех зомби на своей линии и исчезает. Одноразовое использование на уровне.

### **4. Игровые объекты**

#### **4.1 Растения (стартовый набор)**

| Название | Стоимость (Солнце) | Перезарядка (сек) | Описание механики |
| :--- | :--- | :--- | :--- |
| **Горохострел** | 100 | 7.5 | Стреляет одной горошиной по прямой. Базовый атакующий юнит. |
| **Подсолнух** | 50 | 7.5 | Каждые 24 секунды производит одно Солнце (+25). |
| **Стена-орех** | 50 | 30 | Юнит с очень высоким здоровьем. Не атакует, служит для блокировки зомби. |
| **Вишневая бомба** | 150 | 50 | После посадки сразу взрывается, уничтожая всех зомби в радиусе 3x3 ячеек. |

#### **4.2 Зомби (стартовый набор)**

| Название | Здоровье (в условных "горошинах") | Скорость | Особенности |
| :--- | :--- | :--- | :--- |
| **Обычный Зомби** | 10 | Медленная | Нет особенностей. |
| **Зомби с конусом** | 10 + 18.5 (конус) | Медленная | Конус действует как дополнительное здоровье. После уничтожения конуса становится Обычным зомби. |
| **Зомби с ведром** | 10 + 55 (ведро) | Медленная | Ведро обладает очень большим запасом прочности. |
| **Зомби-знаменосец**| 10 | Медленная | Появляется для обозначения начала большой волны. |

### **5. Пользовательский интерфейс (UI/UX)**

*   **Игровой HUD:**
    *   **Верхняя панель:** Слот-карты доступных растений. Отображают стоимость и прогресс перезарядки.
    *   **Верхний левый угол:** Счетчик текущего количества Солнца.
    *   **Нижний правый угол:** Индикатор прогресса волн зомби.
    *   **Кнопка лопаты:** Для удаления растений с поля.
*   **Сцены:**
    *   **Bootstrap:** Сцена-загрузчик. Невидима для игрока.
    *   **MainMenu:** Главное меню с кнопками "Играть", "Настройки", "Выход".
    *   **LevelSelect:** Экран выбора уровня (карта или список).
    *   **Level:** Основная игровая сцена.

### **6. Техническая спецификация**

*   **Движок:** Unity 2022.3 LTS (или новее).
*   **Архитектура:** **DragonECS**.
*   **Структура сцен:** `Bootstrap` -> `MainMenu` -> `Level`.
*   **Конфигурация уровней:** Через `ScriptableObject`. Каждый ассет `LevelConfig` будет содержать информацию о волнах, доступных растениях и т.д.
*   **Ключевые Компоненты (DragonECS):**
    *   **Данные:** `Health`, `MoveSpeed`, `AttackCooldown`, `GridCoordinates`.
    *   **Теги:** `PlantTag`, `ZombieTag`, `ProjectileTag`, `IsDeadTag`.
    *   **События (для `IEcsRunOnEvent`):** `DamageEvent`, `SpawnPlantRequestEvent`, `CollectSunEvent`.
*   **Ключевые Системы (DragonECS):**
    *   **IEcsRun:** `MovementSystem`, `TargetingSystem`, `CollisionSystem`, `ZombieSpawnSystem`, `GameFlowSystem`.
    *   **IEcsRunOnEvent:** `DamageSystem`, `PlantSpawningSystem`, `SunCollectionSystem`.
    *   **Системы очистки:** `CleanupEventsSystem`, `DeathSystem`.
*   **Связь с Unity:** Для отображения будет использоваться "гибридный" подход. Сущность ECS будет содержать компонент-ссылку на `Transform` своего `GameObject`. Системы ECS будут управлять логикой, а `GameObject` будет отвечать только за визуализацию и анимацию.

### **7. Арт и Звук**

*   **Визуальный стиль:** Яркий, мультяшный 2D-стиль, легко читаемый.
*   **Анимации:** Требуются анимации для:
    *   **Зомби:** ходьба, поедание растения, смерть.
    *   **Растения:** idle-анимация, атака, посадка.
    *   **Эффекты:** взрыв, попадание горошины, сбор солнца.
*   **Звук:**
    *   **SFX:** выстрел, попадание, сбор солнца, посадка растения, стоны зомби, взрыв, звук UI.
    *   **Музыка:** Отдельные треки для главного меню и для игровых уровней.

### **8. План разработки (Roadmap)**

1.  **M1: Прототип движения (текущий шаг).**
    *   Настроить проект с DragonECS.
    *   Реализовать спавн одного зомби по конфигу.
    *   Реализовать движение зомби слева направо.

2.  **M2: Базовый боевой цикл.**
    *   Реализовать Горохострел.
    *   Система таргетинга (находит зомби на линии).
    *   Система атаки (спавн снарядов).
    *   Система столкновений и урона (снаряд + зомби).
    *   Система смерти (удаление зомби при health <= 0).

3.  **M3: Экономика и посадка.**
    *   Реализовать спавн и сбор "Солнца".
    *   Реализовать Подсолнух, генерирующий Солнце.
    *   Создать UI для выбора и посадки растений.

4.  **M4: Расширение контента.**
    *   Добавить Стену-орех и Вишневую бомбу.
    *   Добавить Зомби с конусом и ведром.
    *   Реализовать систему волн.

5.  **M5: Полировка и завершение цикла.**
    *   Добавить UI (меню, экраны победы/поражения).
    *   Добавить звуки и базовые визуальные эффекты.
    *   Реализовать газонокосилки.

---

Этот документ — живой. Он будет обновляться и дополняться по мере разработки проекта.